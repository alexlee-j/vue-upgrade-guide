<template>
  <div class="composition-api-page">
    <h1>ğŸ§© ç»„åˆå¼ API</h1>
    <p class="page-description">
      æ·±å…¥äº†è§£ Vue 3 çš„ç»„åˆå¼ APIï¼ŒæŒæ¡å…¶æ ¸å¿ƒæ¦‚å¿µå’Œä½¿ç”¨æ–¹æ³•
    </p>
    
    <section class="section-card">
      <h2>ä»€ä¹ˆæ˜¯ç»„åˆå¼ API</h2>
      <p>ç»„åˆå¼ APIï¼ˆComposition APIï¼‰æ˜¯ Vue 3 å¼•å…¥çš„ä¸€ç§æ–°çš„ä»£ç ç»„ç»‡æ–¹å¼ï¼Œå…è®¸å¼€å‘è€…æŒ‰åŠŸèƒ½ç»„ç»‡ä»£ç ï¼Œè€Œä¸æ˜¯æŒ‰é€‰é¡¹ç±»å‹ã€‚</p>
      <ul>
        <li><strong>è®¾è®¡åŠ¨æœºï¼š</strong>è§£å†³å¤§å‹ç»„ä»¶çš„ä»£ç ç»„ç»‡é—®é¢˜ï¼Œæé«˜é€»è¾‘å¤ç”¨èƒ½åŠ›</li>
        <li><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>åŸºäºå‡½æ•°çš„ APIï¼Œå°†ç›¸å…³é€»è¾‘ç»„ç»‡åœ¨ä¸€èµ·</li>
        <li><strong>ä¸»è¦ä¼˜åŠ¿ï¼š</strong>æ›´å¥½çš„ç±»å‹æ¨æ–­ã€æ›´çµæ´»çš„é€»è¾‘å¤ç”¨ã€æ›´æ¸…æ™°çš„ä»£ç ç»„ç»‡</li>
      </ul>
    </section>
    
    <section class="section-card">
      <h2>æ ¸å¿ƒ API</h2>
      <div class="api-grid">
        <div class="api-item">
          <h3>setup()</h3>
          <p>ç»„ä»¶çš„å…¥å£ç‚¹ï¼Œåœ¨åˆ›å»ºç»„ä»¶å®ä¾‹æ—¶æ‰§è¡Œ</p>
          <div class="code-example">
            <pre><code>export default {
  setup() {
    // ç»„ä»¶é€»è¾‘
    return {
      // æš´éœ²ç»™æ¨¡æ¿çš„å˜é‡å’Œæ–¹æ³•
    }
  }
}</code></pre>
          </div>
        </div>
        <div class="api-item">
          <h3>ref()</h3>
          <p>åˆ›å»ºå“åº”å¼çš„ ref å¯¹è±¡ï¼Œç”¨äºåŸºæœ¬ç±»å‹æ•°æ®</p>
          <div class="code-example">
            <pre><code>import { ref } from 'vue'

const count = ref(0)
console.log(count.value) // 0
count.value++
console.log(count.value) // 1</code></pre>
          </div>
        </div>
        <div class="api-item">
          <h3>reactive()</h3>
          <p>åˆ›å»ºå“åº”å¼çš„å¯¹è±¡ï¼Œç”¨äºå¤æ‚ç±»å‹æ•°æ®</p>
          <div class="code-example">
            <pre><code>import { reactive } from 'vue'

const state = reactive({
  name: 'Vue 3',
  version: '3.4.0'
})
console.log(state.name) // Vue 3</code></pre>
          </div>
        </div>
        <div class="api-item">
          <h3>computed()</h3>
          <p>åˆ›å»ºè®¡ç®—å±æ€§ï¼Œå…·æœ‰ç¼“å­˜æœºåˆ¶</p>
          <div class="code-example">
            <pre><code>import { ref, computed } from 'vue'

const count = ref(0)
const doubleCount = computed(() => count.value * 2)</code></pre>
          </div>
        </div>
        <div class="api-item">
          <h3>watch()</h3>
          <p>ç›‘å¬å“åº”å¼æ•°æ®çš„å˜åŒ–</p>
          <div class="code-example">
            <pre><code>import { ref, watch } from 'vue'

const count = ref(0)
watch(count, (newValue, oldValue) => {
  console.log(`Count changed from ${oldValue} to ${newValue}`)
})</code></pre>
          </div>
        </div>
        <div class="api-item">
          <h3>ç”Ÿå‘½å‘¨æœŸé’©å­</h3>
          <p>ç»„åˆå¼ API é£æ ¼çš„ç”Ÿå‘½å‘¨æœŸé’©å­</p>
          <div class="code-example">
            <pre><code>import { onMounted, onUnmounted } from 'vue'

onMounted(() => {
  console.log('Component mounted')
})

onUnmounted(() => {
  console.log('Component unmounted')
})</code></pre>
          </div>
        </div>
      </div>
    </section>
    
    <section class="section-card">
      <h2>ä¸é€‰é¡¹ API çš„å¯¹æ¯”</h2>
      <div class="comparison-grid">
        <div class="comparison-item">
          <h3>é€‰é¡¹ API</h3>
          <ul>
            <li>æŒ‰é€‰é¡¹ç±»å‹ç»„ç»‡ä»£ç ï¼ˆdataã€methodsã€computed ç­‰ï¼‰</li>
            <li>ä½¿ç”¨ mixins è¿›è¡Œé€»è¾‘å¤ç”¨ï¼Œå¯èƒ½å¯¼è‡´å‘½åå†²çª</li>
            <li>TypeScript æ”¯æŒæœ‰é™</li>
            <li>å¤§å‹ç»„ä»¶çš„é€»è¾‘åˆ†æ•£ï¼Œéš¾ä»¥ç»´æŠ¤</li>
          </ul>
        </div>
        <div class="comparison-item">
          <h3>ç»„åˆå¼ API</h3>
          <ul>
            <li>æŒ‰åŠŸèƒ½ç»„ç»‡ä»£ç ï¼Œç›¸å…³é€»è¾‘é›†ä¸­åœ¨ä¸€èµ·</li>
            <li>ä½¿ç”¨ Composables è¿›è¡Œé€»è¾‘å¤ç”¨ï¼Œé¿å…å‘½åå†²çª</li>
            <li>æ›´å¥½çš„ TypeScript æ”¯æŒ</li>
            <li>å¤§å‹ç»„ä»¶çš„é€»è¾‘æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤</li>
            <li>æ›´çµæ´»çš„ä»£ç ç»„ç»‡æ–¹å¼</li>
          </ul>
        </div>
      </div>
      <div class="code-example">
        <h4>ä»£ç ç»„ç»‡å¯¹æ¯”ï¼š</h4>
        <pre><code>// é€‰é¡¹ API
export default {
  data() {
    return {
      count: 0,
      message: 'Hello'
    }
  },
  methods: {
    increment() {
      this.count++
    },
    updateMessage() {
      this.message = 'Updated'
    }
  },
  computed: {
    doubleCount() {
      return this.count * 2
    }
  }
}

// ç»„åˆå¼ API
import { ref, computed } from 'vue'

export default {
  setup() {
    // è®¡æ•°é€»è¾‘
    const count = ref(0)
    const doubleCount = computed(() => count.value * 2)
    const increment = () => count.value++
    
    // æ¶ˆæ¯é€»è¾‘
    const message = ref('Hello')
    const updateMessage = () => message.value = 'Updated'
    
    return {
      count,
      doubleCount,
      increment,
      message,
      updateMessage
    }
  }
}</code></pre>
      </div>
    </section>
    
    <section class="section-card">
      <h2>é€»è¾‘å¤ç”¨ - Composables</h2>
      <p>ç»„åˆå¼ API çš„ä¸€ä¸ªé‡è¦ä¼˜åŠ¿æ˜¯èƒ½å¤Ÿåˆ›å»ºå¯å¤ç”¨çš„é€»è¾‘æ¨¡å—ï¼Œç§°ä¸º Composablesã€‚</p>
      <div class="code-example">
        <h4>åˆ›å»ºå’Œä½¿ç”¨ Composableï¼š</h4>
        <pre><code>// composables/useCounter.ts
import { ref, computed, watch } from 'vue'

export function useCounter(initialValue = 0) {
  const count = ref(initialValue)
  const doubleCount = computed(() => count.value * 2)
  
  const increment = () => count.value++
  const decrement = () => count.value--
  const reset = () => count.value = initialValue
  
  watch(count, (newValue) => {
    console.log('Count changed:', newValue)
  })
  
  return {
    count,
    doubleCount,
    increment,
    decrement,
    reset
  }
}

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
import { useCounter } from '@/composables/useCounter'

export default {
  setup() {
    const { count, doubleCount, increment } = useCounter(0)
    
    return {
      count,
      doubleCount,
      increment
    }
  }
}</code></pre>
      </div>
    </section>
    
    <section class="section-card">
      <h2>æœ€ä½³å®è·µ</h2>
      <ul>
        <li><strong>æŒ‰åŠŸèƒ½ç»„ç»‡ä»£ç ï¼š</strong>å°†ç›¸å…³é€»è¾‘é›†ä¸­åœ¨ä¸€èµ·ï¼Œæé«˜å¯è¯»æ€§</li>
        <li><strong>åˆç†ä½¿ç”¨ Composablesï¼š</strong>å°†å¯å¤ç”¨é€»è¾‘æå–ä¸º Composables</li>
        <li><strong>ä½¿ç”¨ TypeScriptï¼š</strong>å……åˆ†åˆ©ç”¨ç»„åˆå¼ API çš„ç±»å‹æ¨æ–­ä¼˜åŠ¿</li>
        <li><strong>æ³¨æ„å“åº”æ€§ï¼š</strong>ç†è§£ ref å’Œ reactive çš„åŒºåˆ«ï¼Œæ­£ç¡®ä½¿ç”¨</li>
        <li><strong>é¿å…è¿‡åº¦åµŒå¥—ï¼š</strong>ä¿æŒ setup å‡½æ•°çš„ç®€æ´æ€§</li>
        <li><strong>ä½¿ç”¨ provide/injectï¼š</strong>åœ¨ç»„ä»¶æ ‘ä¸­å…±äº«çŠ¶æ€</li>
      </ul>
    </section>
    
    <section class="section-card">
      <h2>å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</h2>
      <div class="faq-grid">
        <div class="faq-item">
          <h3>â“ å¿˜è®°ä½¿ç”¨ .value</h3>
          <p><strong>é—®é¢˜ï¼š</strong>åœ¨ setup å‡½æ•°ä¸­ç›´æ¥ä½¿ç”¨ ref å€¼ï¼Œå¿˜è®°æ·»åŠ  .value</p>
          <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>è®°ä½åœ¨ setup å‡½æ•°ä¸­æ“ä½œ ref æ—¶éœ€è¦ä½¿ç”¨ .valueï¼Œåœ¨æ¨¡æ¿ä¸­åˆ™ä¸éœ€è¦</p>
        </div>
        <div class="faq-item">
          <h3>â“ this ä¸Šä¸‹æ–‡</h3>
          <p><strong>é—®é¢˜ï¼š</strong>åœ¨ç»„åˆå¼ API ä¸­æ‰¾ä¸åˆ° this</p>
          <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>ç»„åˆå¼ API ä¸­æ²¡æœ‰ thisï¼Œä½¿ç”¨ setup å‡½æ•°è¿”å›çš„å˜é‡å’Œæ–¹æ³•</p>
        </div>
        <div class="faq-item">
          <h3>â“ å“åº”æ€§ä¸¢å¤±</h3>
          <p><strong>é—®é¢˜ï¼š</strong>è§£æ„ reactive å¯¹è±¡åä¸¢å¤±å“åº”æ€§</p>
          <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>ä½¿ç”¨ toRefs æˆ– toRef ä¿æŒå“åº”æ€§ï¼Œæˆ–ç›´æ¥ä½¿ç”¨ ref</p>
        </div>
        <div class="faq-item">
          <h3>â“ ç”Ÿå‘½å‘¨æœŸé’©å­</h3>
          <p><strong>é—®é¢˜ï¼š</strong>ä¸çŸ¥é“å¦‚ä½•åœ¨ç»„åˆå¼ API ä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­</p>
          <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>ä» vue å¯¼å…¥å¯¹åº”çš„ onXXX é’©å­å‡½æ•°å¹¶åœ¨ setup ä¸­ä½¿ç”¨</p>
        </div>
      </div>
    </section>
  </div>
</template>

<script setup lang="ts">
// Composition API page component
</script>

<style scoped>
.composition-api-page {
  padding: 1rem;
  max-width: 1000px;
  margin: 0 auto;
}

.page-description {
  font-size: 1.2rem;
  color: var(--color-text-secondary);
  margin-bottom: 2rem;
  text-align: center;
}

.section-card {
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 8px;
  padding: 1.5rem;
  margin-bottom: 2rem;
}

.section-card h2 {
  margin-top: 0;
  color: var(--color-text);
  border-bottom: 2px solid var(--color-primary);
  padding-bottom: 0.5rem;
}

.section-card ul {
  padding-left: 1.5rem;
}

.section-card li {
  margin-bottom: 0.5rem;
}

.api-grid,
.comparison-grid,
.faq-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
  margin-top: 1.5rem;
}

.api-item,
.comparison-item,
.faq-item {
  background-color: var(--color-bg);
  border: 1px solid var(--color-border);
  border-radius: 4px;
  padding: 1rem;
}

.api-item h3,
.comparison-item h3,
.faq-item h3 {
  margin-top: 0;
  color: var(--color-text);
}

.code-example {
  background-color: var(--color-bg);
  border: 1px solid var(--color-border);
  border-radius: 4px;
  padding: 1rem;
  margin-top: 1rem;
  overflow-x: auto;
}

.code-example h4 {
  margin-top: 0;
  color: var(--color-text);
}

.code-example pre {
  margin: 0;
  font-family: 'Courier New', Courier, monospace;
  font-size: 0.9rem;
}
</style>
